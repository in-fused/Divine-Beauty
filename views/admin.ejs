<%- include('partials/head', { title: 'Admin Dashboard | Divine Beauty' }) %>
<section class="container section">
  <div class="admin-top">
    <h1>Admin Dashboard</h1>
    <form method="post" action="/admin/logout"><button class="btn-inline">Logout</button></form>
  </div>
  <p>Manage openings, content, and image uploads from iPhone-friendly controls.</p>
</section>

<section class="container section admin-grid">
  <article class="card">
    <h2>Add Availability Slot</h2>
    <form method="post" action="/admin/slots" class="stack">
      <label>Label <input name="label" placeholder="Morning Silk Press" /></label>
      <label>Start <input name="startAt" type="datetime-local" required /></label>
      <label>End <input name="endAt" type="datetime-local" required /></label>
      <label>Max bookings <input name="maxBookings" type="number" min="1" value="1" /></label>
      <button class="btn">Save Slot</button>
    </form>
  </article>

  <article class="card">
    <h2>Add Service</h2>
    <form method="post" action="/admin/services" class="stack">
      <label>Name <input name="name" required /></label>
      <label>Description <textarea name="description" rows="2"></textarea></label>
      <label>Duration (minutes) <input type="number" name="durationMinutes" value="60" /></label>
      <label>Price (USD) <input type="number" step="0.01" name="priceDollars" value="0.00" /></label>
      <button class="btn">Save Service</button>
    </form>
  </article>

  <article class="card">
    <h2>Upload Portfolio Image</h2>
    <form method="post" action="/admin/gallery/upload" enctype="multipart/form-data" class="stack">
      <label>Title <input name="title" /></label>
      <label>Image <input type="file" accept="image/*" name="image" required /></label>
      <button class="btn">Upload</button>
    </form>
    <hr />
    <form method="post" action="/admin/gallery/instagram" class="stack">
      <label>Instagram Image URL <input type="url" name="imageUrl" placeholder="https://..." required /></label>
      <label>Title <input name="title" /></label>
      <button class="btn-inline">Attach via URL</button>
    </form>
  </article>

  <article class="card">
    <h2>Publish Blog Post</h2>
    <form method="post" action="/admin/posts" enctype="multipart/form-data" class="stack">
      <label>Title <input name="title" required /></label>
      <label>Body <textarea name="body" rows="5" required></textarea></label>
      <label>Optional image <input type="file" accept="image/*" name="image" /></label>
      <button class="btn">Publish</button>
    </form>
  </article>
</section>

<section class="container section">
  <h2>Recent Bookings</h2>
  <div class="table-wrap">
    <table>
      <thead><tr><th>Client</th><th>Contact</th><th>Slot</th><th>Status</th><th>Notes</th></tr></thead>
      <tbody>
      <% bookings.forEach((booking) => { %>
        <tr>
          <td><%= booking.name %></td>
          <td><%= booking.phone || booking.email %></td>
          <td><%= new Date(booking.start_at).toLocaleString() %></td>
          <td><%= booking.status %></td>
          <td><%= booking.custom_notes || '' %></td>
        </tr>
      <% }) %>
      </tbody>
    </table>
  </div>
</section>
<%- include('partials/foot') %>
